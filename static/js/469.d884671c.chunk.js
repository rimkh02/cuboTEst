"use strict";(self.webpackChunk_minimal_material_kit_react=self.webpackChunk_minimal_material_kit_react||[]).push([[469],{60167:function(e,t,n){n.d(t,{Z:function(){return y}});var o=n(1413),r=n(29439),a=n(45987),i=n(47313),l=n(75627),s=n(77914),d=n(59017),u=n(18104),m=n(6621),c=n(80133),p=n(18588),h=n(10978),v=n(94085),f=n(69862),x=n(46417),g=["itemName","name","helperText","type","endAdornment"];function y(e){var t=e.itemName,n=e.name,y=e.helperText,Z=e.type,j=e.endAdornment,b=(0,a.Z)(e,g),C=(0,l.Gc)().control,N=(0,c.nt)().currentLang,_=(0,f.S)(),D=(0,i.useState)(""),S=(0,r.Z)(D,2),w=S[0],q=S[1],k=(0,i.useState)(""),E=(0,r.Z)(k,2),L=E[0],Y=E[1],I=(0,i.useCallback)((function(e){q(e.target.value)}),[]),T=""!==w?p.h.filter((function(e){return-1!==e.labelFr.toLowerCase().indexOf(w.toLowerCase())||-1!==e.labelEn.toLowerCase().indexOf(w.toLowerCase())})):p.h;return"phone"===Z?(0,x.jsx)(l.Qr,{name:n,control:C,render:function(e){var n=e.field,r=e.fieldState.error;return(0,x.jsx)(s.Z,(0,o.Z)((0,o.Z)({},n),{},{fullWidth:!0,type:Z,value:"number"===Z&&0===n.value?"":n.value,onChange:function(e){"number"===Z?n.onChange(Number(e.target.value)):n.onChange(e.target.value)},error:!!r,helperText:r?null===r||void 0===r?void 0:r.message:y,InputProps:{startAdornment:(0,x.jsx)(l.Qr,{name:t,control:C,render:function(e){var t,n;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(d.Z,{position:"start",children:[(0,x.jsx)(u.Z,{onClick:_.onOpen,children:(0,x.jsx)(h.Z,{icon:"circle-flags:".concat(1===p.h.filter((function(t){return t.phone===e.field.value})).length||""===L?null===(t=p.h.filter((function(t){return t.phone===e.field.value}))[0])||void 0===t?void 0:t.code.toLowerCase():null===(n=p.h.filter((function(t){return t.phone===e.field.value&&L===t.id}))[0])||void 0===n?void 0:n.code.toLowerCase()),width:28})}),(0,x.jsxs)(f.Z,{open:_.open,onClose:_.onClose,children:[(0,x.jsx)(s.Z,{value:w,onChange:I,placeholder:"",fullWidth:!0,sx:{p:1}}),(0,x.jsx)(v.Z,{sx:{maxHeight:250,width:300},children:T.map((function(t){return(0,x.jsxs)(m.Z,{sx:{width:300},onClick:function(){e.field.onChange(t.phone),_.onClose(),Y(t.id)},children:[(0,x.jsx)(h.Z,{icon:"circle-flags:".concat(null===t||void 0===t?void 0:t.code.toLowerCase()),width:28,sx:{mr:1}}),"fr"===N.value?null===t||void 0===t?void 0:t.labelFr:t.labelEn,"\xa0",null===t||void 0===t?void 0:t.phone]},t.id)}))})]})]}),(0,x.jsx)(d.Z,{position:"end",sx:{mr:1},children:e.field.value})]})}}),endAdornment:j}},b))}}):(0,x.jsx)(l.Qr,{name:n,control:C,render:function(e){var t=e.field,n=e.fieldState.error;return(0,x.jsx)(s.Z,(0,o.Z)((0,o.Z)({},t),{},{fullWidth:!0,type:Z,value:"number"===Z&&0===t.value?"":t.value,onChange:function(e){"number"===Z?t.onChange(Number(e.target.value)):t.onChange(e.target.value)},error:!!n,helperText:n?null===n||void 0===n?void 0:n.message:y},b))}})}},95469:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var o=n(65964),r=n(58467),a=n(47313),i=n(80941),l=n(16157),s=n(34207),d=n(62463),u=n(76025),m=n(87130),c=n(24969),p=n(11589),h=n(80133),v=n(1333),f=n(84271),x=n(46417);function g(){var e,t=(0,m.K$)().themeStretch,n=(0,h.nt)().translate,g=(0,v.I0)(),y=(0,r.UO)().id,Z=(0,v.v9)((function(e){return e.employee})),j=Z.employee,b=Z.isLoading;return(0,a.useEffect)((function(){g((0,f.WK)({id:y}))}),[g,y]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(o.ql,{children:(0,x.jsxs)("title",{children:[" ",n("employee.employees")]})}),(0,x.jsxs)(i.Z,{maxWidth:!t&&"lg",children:[(0,x.jsx)(c.Z,{heading:n("employee.edit_employee"),links:[{name:n("Dashboard"),href:u.vB.general.homeComany},{name:n("employee.employees"),href:u.vB.employee.list},{name:null===j||void 0===j||null===(e=j.employee)||void 0===e?void 0:e.firstName}]}),b?(0,x.jsx)(l.Z,{sx:{display:"flex",flex:1,alignItems:"center",justifyContent:"center",height:300,width:"100%"},children:(0,x.jsx)(s.Z,{size:40,color:"primary"})}):(0,x.jsxs)(x.Fragment,{children:[" ",j&&(0,x.jsx)(d.Z,{spacing:4,children:(0,x.jsx)(p.Z,{isEdit:!0,currentEmployee:j})})]})]})]})}},11589:function(e,t,n){n.d(t,{Z:function(){return M}});var o=n(1413),r=n(74165),a=n(15861),i=n(29439),l=n(69973),s=n(47313),d=n(58467),u=n(2135),m=(n(87131),n(75627)),c=n(62563),p=n(32703),h=n(82937),v=n(92484),f=n(42669),x=n(16157),g=n(77914),y=n(6621),Z=n(62463),j=n(73477),b=n(43394),C=n(32091),N=n(72905),_=n(76025),D=n(68986),S=n(11154),w=n(60167),q=n(80133),k=n(63129),E=n(1333),L=n(84271),Y=n(2464),I=(n(32454),n(70816)),T=n.n(I),A=n(46417);function M(e){var t=e.isEdit,n=void 0!==t&&t,I=e.currentEmployee,M=(0,d.s0)(),F=(0,q.nt)(),P=F.translate,W=F.currentLang,z=(0,E.I0)(),G=(0,D.Ds)().enqueueSnackbar,H=(0,E.v9)((function(e){return e.categories})).categories,O=(0,E.v9)((function(e){return e.employee})).isEmployeeLoading,B=(0,s.useState)(!1),Q=(0,i.Z)(B,2),$=(Q[0],Q[1],(0,s.useState)(!1)),V=(0,i.Z)($,2),K=V[0],U=V[1],R=(0,s.useState)(!1),X=(0,i.Z)(R,2),J=(X[0],X[1],l.object().shape({firstName:l.string().required(P("employee.first_name_required")).max(20,P("employee.firstName_max")).matches(/^[a-zA-Z\xc0-\xff\s]+$/,P("employee.firstName_alpha")),lastName:l.string().required(P("employee.last_name_required")).max(20,P("employee.lastName_max")).matches(/^[a-zA-Z\xc0-\xff\s]+$/,P("employee.lastName_alpha")),email:l.string().required(P("employee.email_required")).email(P("employee.mail_invalid")).max(100,P("employee.mail_invalid")),phone:l.string().required(P("employee.phone_required")).matches(/^((\d{9}))$/,P("employee.phone_invalid")),phoneCode:l.string().default(k.Gp),position:l.string().required(P("companies.position_required")).max(40,P("employee.position_max")).min(2,P("employee.position_min")),registrationNumber:l.string().max(20,P("employee.identifier_max")),category:l.string().required(P("employee.cagnotte_required")),startDate:l.date().nullable().required(P("employee.contract.startDate_required"))})),ee=(0,s.useMemo)((function(){var e,t,n,o,r,a,i,l,s,d,u,m;return{firstName:(null===I||void 0===I||null===(e=I.employee)||void 0===e?void 0:e.firstName)||"",lastName:(null===I||void 0===I||null===(t=I.employee)||void 0===t?void 0:t.lastName)||"",email:(null===I||void 0===I||null===(n=I.employee)||void 0===n?void 0:n.email)||"",position:(null===I||void 0===I||null===(o=I.contract)||void 0===o?void 0:o.position)||"",category:(null===I||void 0===I||null===(r=I.contract)||void 0===r?void 0:r.categoryId)||"",registrationNumber:(null===I||void 0===I||null===(a=I.contract)||void 0===a?void 0:a.registrationNumber)||"",phone:(null===I||void 0===I||null===(i=I.employee)||void 0===i?void 0:i.phone.replace(k.Sm,""))||"",phoneCode:null!==I&&void 0!==I&&null!==(l=I.employee)&&void 0!==l&&l.phone?null===I||void 0===I||null===(s=I.employee)||void 0===s?void 0:s.phone.slice(0,(null===(d=I.employee)||void 0===d?void 0:d.phone.length)-(null===(u=I.employee)||void 0===u?void 0:u.phone.replace(k.Sm,"").length)):k.Gp,startDate:(null===I||void 0===I||null===(m=I.contract)||void 0===m?void 0:m.startDate)||new Date}}),[I]),te=(0,m.cI)({mode:"all",reValidateMode:"onChange",resolver:(0,c.X)(J),defaultValues:ee}),ne=te.watch,oe=te.control,re=ne(),ae=te.reset,ie=te.handleSubmit,le=te.formState.isDirty;(0,s.useEffect)((function(){n&&I&&ae(ee),n||ae(ee)}),[n,I]);var se=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var o,a,i,l,s,d,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={startDate:T()(new Date(null===(o=t.startDate)||void 0===o?void 0:o.toString())).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"),position:t.position,registrationNumber:t.registrationNumber},n?(s={firstName:t.firstName,lastName:t.lastName,email:t.email,phone:"".concat(t.phoneCode).concat(t.phone),position:t.position},d=function(){return(null===ee||void 0===ee?void 0:ee.category)!==re.category},u=(null===ee||void 0===ee?void 0:ee.startDate)!==re.startDate||(null===ee||void 0===ee?void 0:ee.position)!==re.position||(null===ee||void 0===ee?void 0:ee.registrationNumber)!==re.registrationNumber,d()?z((0,L.Oi)({data:s,dataContract:u?a:null,currentEmployee:I,navigate:M,translate:P,categoryId:t.category,toast:G})):z((0,L.vV)({data:s,dataContract:u?a:null,currentEmployee:I,navigate:M,translate:P,toast:G}))):(l={firstName:t.firstName,lastName:t.lastName,email:t.email,phone:"".concat(t.phoneCode).concat(t.phone),position:t.position,assignedCategoryId:parseInt(t.category),registrationNumber:t.registrationNumber,startDate:T()(new Date(null===(i=t.startDate)||void 0===i?void 0:i.toString())).format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")},z((0,L.vu)({data:l,dataContract:a,navigate:M,translate:P,toast:G})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){z((0,Y.kw)({}))}),[z]),(0,A.jsx)(S.ZP,{methods:te,onSubmit:ie(se),children:(0,A.jsx)(h.ZP,{spacing:3,children:(0,A.jsx)(h.ZP,{item:!0,xs:12,md:8,children:(0,A.jsxs)(v.Z,{sx:{p:3},children:[(0,A.jsx)(f.Z,{variant:"subtitle2",sx:{color:"text.secondary",mb:3},children:P("employee.infos_employee")}),(0,A.jsxs)(x.Z,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[(0,A.jsx)(S.au,{name:"firstName",label:P("employee.first_name"),placeholder:"john"}),(0,A.jsx)(S.au,{name:"lastName",label:P("employee.last_name"),placeholder:"Durand"}),(0,A.jsx)(S.au,{name:"email",label:P("Email"),placeholder:"john@exemple.com"}),(0,A.jsx)(w.Z,{name:"phone",label:P("Phone"),itemName:"phoneCode",type:"phone",placeholder:"234567890"}),(0,A.jsx)(S.au,{name:"position",label:P("companies.position"),placeholder:"DG"}),(0,A.jsx)(S.au,{name:"registrationNumber",label:P("employee.identifier"),placeholder:"ABC001"}),(0,A.jsx)(b._,{dateAdapter:N.y,adapterLocale:W.value,children:(0,A.jsx)(m.Qr,{name:"startDate",control:oe,render:function(e){var t=e.field,n=e.fieldState.error;return(0,A.jsx)(C.M,(0,o.Z)((0,o.Z)({},t),{},{label:P("employee.contract.startDate"),inputFormat:"DD/MM/YYYY",disableFuture:!0,open:K,onClose:function(){return U(!1)},renderInput:function(e){return(0,A.jsx)(g.Z,(0,o.Z)((0,o.Z)({size:"medium",fullWidth:!0},e),{},{error:!!n,helperText:null===n||void 0===n?void 0:n.message,onClick:function(){return U(!0)}}))}}))}})}),(0,A.jsx)(S.Cc,{fullWidth:!0,name:"category",label:P("cagnotte.cagnotte"),InputLabelProps:{shrink:!0},SelectProps:{native:!1,sx:{textTransform:"capitalize"}},children:null===H||void 0===H?void 0:H.map((function(e){return(0,A.jsx)(y.Z,{value:e.id,sx:{mx:1,my:.5,borderRadius:.75,typography:"body2",textTransform:"capitalize","&:first-of-type":{mt:0},"&:last-of-type":{mb:0}},children:e.name},e.id)}))})]}),(0,A.jsx)(Z.Z,{spacing:3,children:(0,A.jsxs)(x.Z,{sx:{textAlign:"right",mt:3},children:[(0,A.jsx)(j.Z,{component:u.rU,to:_.vB.employee.list,variant:"outlined",color:"inherit",sx:{mr:1},children:P("Cancel")}),(0,A.jsx)(p.Z,{disabled:!le,type:"submit",variant:"contained",loading:O,children:P("save")})]})})]})})})})}}}]);